<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Ratio estimate to census landings — AnalyticalRatioEstimate • RstoxFDA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Ratio estimate to census landings — AnalyticalRatioEstimate"><meta name="description" content="Performs ratio estimate adjustments of estimates, based on frequency and mean weights of each domain."><meta property="og:description" content="Performs ratio estimate adjustments of estimates, based on frequency and mean weights of each domain."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RstoxFDA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0-9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Stox-Analytical.html">StoX-Analytical-Estimates</a></li>
    <li><a class="dropdown-item" href="../articles/StoX-data-preparation.html">StoX FDA data preparation (baseline)</a></li>
    <li><a class="dropdown-item" href="../articles/Stox-FDA-overview.html">StoX Fisheries overview (report)</a></li>
    <li><a class="dropdown-item" href="../articles/stox-reca.html">StoX-Reca (analysis)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/StoXProject/RstoxFDA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Ratio estimate to census landings</h1>
      <small class="dont-index">Source: <a href="https://github.com/StoXProject/RstoxFDA/blob/master/R/StoxAnalyticalBaselineFunctions.R" class="external-link"><code>R/StoxAnalyticalBaselineFunctions.R</code></a></small>
      <div class="d-none name"><code>AnalyticalRatioEstimate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs ratio estimate adjustments of estimates, based on frequency and mean weights of each domain.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AnalyticalRatioEstimate</span><span class="op">(</span></span>
<span>  <span class="va">AnalyticalPopulationEstimateData</span>,</span>
<span>  <span class="va">StoxLandingData</span>,</span>
<span>  WeightVariable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  StratificationVariables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  DomainVariables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-analyticalpopulationestimatedata">AnalyticalPopulationEstimateData<a class="anchor" aria-label="anchor" href="#arg-analyticalpopulationestimatedata"></a></dt>
<dd><p><code><a href="AnalyticalPopulationEstimateData.html">AnalyticalPopulationEstimateData</a></code> with estimates of mean or total weights and frequencies or abundance in domains</p></dd>


<dt id="arg-stoxlandingdata">StoxLandingData<a class="anchor" aria-label="anchor" href="#arg-stoxlandingdata"></a></dt>
<dd><p><code><a href="https://rdrr.io/pkg/RstoxData/man/StoxLandingData.html" class="external-link">StoxLandingData</a></code> with census data on total weight in each stratum</p></dd>


<dt id="arg-weightvariable">WeightVariable<a class="anchor" aria-label="anchor" href="#arg-weightvariable"></a></dt>
<dd><p>character() name of variable in 'AnalyticalPopulationEstimateData' that represent weight of individuals in grams.</p></dd>


<dt id="arg-stratificationvariables">StratificationVariables<a class="anchor" aria-label="anchor" href="#arg-stratificationvariables"></a></dt>
<dd><p>vector of stratification columns to include when matching estimates to landings. Variable must exist as Stratification Variable in 'AnalyticalPopulationEstimateData' and in 'StoxLandingData'</p></dd>


<dt id="arg-domainvariables">DomainVariables<a class="anchor" aria-label="anchor" href="#arg-domainvariables"></a></dt>
<dd><p>vector of domain columns to include when matching estimates to landings. Variable must exist as Domain Variable in 'AnalyticalPopulationEstimateData' and in 'StoxLandingData'</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code><a href="AnalyticalPopulationEstimateData.html">AnalyticalPopulationEstimateData</a></code> with ratio estimates.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Ratio estimates of abundance are obtained by relating abundance to weight and utilizing census data on landed weight to potentially improve estimates.
Ratio estimation generally incurs some bias in estimation, and analytical expressions for variances are approximate.</p>
<p>Landings are partitioned and assigned to domains in 'AnalyticalPopulationEstimateData' by matching column names.
Column names in 'StoxLandingData' that are also either Stratification Columns or Domain Columns in 'AnalyticalPopulationEstimateData'
can be used to construct the 'landing partitions' that provide total weigths for the ratio estimates.</p>
<p>Ratio estimation of abundance may either improve an estimate of abundance obtained by other means, or provide an estimate of abundance
when only proportions in domains are known. This requires that landing partitions are not covering more than one strata, although they may cover less.
That is the Stratification columns in 'StratificationColumns' must identify strata in 'AnalyticalPopulationEstimateData'</p>
<p>The function obtains a ratio estimate of total abundance in landings by relating proportion in domains, mean weight in domains, and total weight in landings to each other:</p>
<p>'Abundance' will be estimated as \(\widehat{qN}^{(s,d)}\), the variable 'Frequency' as \(\widehat{qf}^{(s,d)}\), and the variable 'Total' as \(\widehat{qt}^{(s,d,v)}\).
These estimators and their corresponding variances ('AbundanceCovariance', 'FrequencyCovariance', and 'TotalCovariance') are given below.
Note that no revised estimate for means are provided with this method. 'Mean' and MeanCovariance' are unchanged.
The estimates are based on estimated frequencies and ratio of of total landings in each landing partition to the estimated mean individual weight ('WeightVariable'):
$$\hat{Q}^{(s,d)}=\frac{W^{(L)}}{\sum_{(s',d') \in L}\hat{f}^{(s',d')}\hat{\mu}^{(s',d',\mathrm{w})}}$$
where \(L=part(s,d)\) is a partition of the landings containing the domain, specified by the arguments 'StratificationVariables' and 'DomainVariables'.
Since frequencies are normalized to strata, L cannot contain several strata.
The abundance is estimated as:
$$\widehat{qN}^{(s,d)} = \hat{f}^{(s,d)}\hat{Q}^{(s,d)}$$
And covariances are estimated as:
$$\widehat{CoVar}(\widehat{qN}^{(s,d_{1})}, \widehat{qN}^{(s,d_{2})}) = \hat{Q}^{(s,d_{1})}\hat{Q}^{(s,d_{2})}\widehat{CoVar}(\hat{f}^{(s,d_{1})}, \hat{f}^{(s,d_{2})})$$
ignoring the error in \(\hat{Q}^{(s,d)}\).
The frequency is estimated as:
$$\widehat{qf}^{(s,d)} = \frac{\widehat{qN}^{(s,d)}}{\widehat{qN}^{(s)}}$$
And covariances are estimated as:
$$\widehat{CoVar}(\widehat{qf}^{(s,d_{1})}, \widehat{qf}^{(s,d_{2})}) = \frac{1}{\widehat{qN}^{(s)}}\widehat{CoVar}(\widehat{qN}^{(s,d_{1})}, \widehat{qN}^{(s,d_{2})})$$
ignoring the error in \(\widehat{qN}^{(s)}\).
Totals are estimated as:
$$\widehat{qt}^{(s,d,v)} = \widehat{qN}^{(s,d)}\hat{\mu}^{(s,d,v)}$$
And covariances are estimated as:
$$\widehat{CoVar}(\widehat{qt}^{(s,d_{1},v_{1})}, \widehat{qt}^{(s,d_{2},v_{2})}) = \widehat{qN}^{(s,d_{1})}\widehat{qN}^{(s,d_{2})}\widehat{CoVar}(\hat{\mu}^{(s,d_{1},v_{1})}, \hat{\mu}^{(s,d_{2},v_{2})})$$
ignoring the error in \(\widehat{qN}^{(s,d)}\).
Note that no revised estimate for means are provided with this method. 'Mean' and MeanCovariance' is unchanged.</p>
<p>Vocabulary for equations given above:</p><dl><dt>\(part(s,d)\)</dt>
<dd><p>The partition of the landings containing the domain \(d\) in stratum \(s\).</p></dd>

<dt>\(\hat{N}^{(s,d)}\)</dt>
<dd><p>The estimated abundance in the domain \(d\) in stratum \(s\). 'Abundance' in <code><a href="AnalyticalPopulationEstimateData.html">AnalyticalPopulationEstimateData</a></code>.</p></dd>

<dt>\(\hat{t}^{(s,d,v)}\)</dt>
<dd><p>The estimated total of variable \(v\) in domain \(d\) in stratum \(s\). The 'Total' for the 'Variable' \(v\) in <code><a href="AnalyticalPopulationEstimateData.html">AnalyticalPopulationEstimateData</a></code>.</p></dd>

<dt>\(\hat{t}^{(s,d,\mathrm{w})}\)</dt>
<dd><p>The estimated total weight in domain \(d\) in stratum \(s\). The 'Total' for the 'Variable' identified by the argument 'WeightVariable' in <code><a href="AnalyticalPopulationEstimateData.html">AnalyticalPopulationEstimateData</a></code>.</p></dd>

<dt>\(\hat{\mu}^{(s,d,v)}\)</dt>
<dd><p>The estimated mean of the variable \(v\) in domain \(d\) in stratum \(s\). The 'Mean' for the 'Variable' \(v\) in <code><a href="AnalyticalPopulationEstimateData.html">AnalyticalPopulationEstimateData</a></code>.</p></dd>

<dt>\(\hat{\mu}^{(s,d,\mathrm{w})}\)</dt>
<dd><p>The estimated mean weight in domain \(d\) in stratum \(s\). The 'Mean' for the 'Variable' identified by the argument 'WeightVariable' in <code><a href="AnalyticalPopulationEstimateData.html">AnalyticalPopulationEstimateData</a></code>.</p></dd>

<dt>\(\hat{t}^{(L,\mathrm{w})}\)</dt>
<dd><p>The estimated total weight in the landing partition: \(\hat{t}^{(L)}=\sum_{(s,d) \in L}\hat{t}^{(s,d,\mathrm{w})}\)</p></dd>

<dt>\(\widehat{rN}^{(s)}\)</dt>
<dd><p>The estimated total abundance in stratum \(s\), based on total domain weight estimates: \(\widehat{rN}^{(s)}=\sum_{d}\widehat{rN}^{(s,d)}\), where the sum runs over all domains in stratum \(s\).</p></dd>

<dt>\(\widehat{qN}^{(s)}\)</dt>
<dd><p>The estimated total abundance in stratum \(s\), based on mean domain weight estimates: \(\widehat{qN}^{(s)}=\sum_{d}\widehat{qN}^{(s,d)}\), where the sum runs over all domains in stratum \(s\).</p></dd>

<dt>\(\widehat{CoVar}(\hat{N}^{(s,d_{1})}, \hat{N}^{(s,d_{2})})\)</dt>
<dd><p>The estimated covariance of abundance between the domains \(d_{1}\) and \(d_{2}\) in stratum \(s\). 'AbundanceCovariance' in <code><a href="AnalyticalPopulationEstimateData.html">AnalyticalPopulationEstimateData</a></code>.</p></dd>

<dt>\(\hat{f}^{(s,d)}\)</dt>
<dd><p>The estimated frequency in domain \(d\) in stratum \(s\). 'Frequency' in <code><a href="AnalyticalPopulationEstimateData.html">AnalyticalPopulationEstimateData</a></code>.</p></dd>

<dt>\(\widehat{CoVar}(\hat{f}^{(s,d_{1})}, \hat{f}^{(s,d_{2})})\)</dt>
<dd><p>The estimated covariance of frequencies between the domains \(d_{1}\) and \(d_{2}\) in stratum \(s\). 'FrequencyCovariance' in <code><a href="AnalyticalPopulationEstimateData.html">AnalyticalPopulationEstimateData</a></code>.</p></dd>

<dt>\(\widehat{CoVar}(\hat{t}^{(s,d_{1},v_{1})}, \hat{f}^{(s,d_{2},v_{2})})\)</dt>
<dd><p>The estimated covariance of totals between the variable \(v_{1}\) in domain \(d_{1}\) and the variable \(v_{2}\) in domain \(d_{2}\) in stratum \(s\). 'TotalCovariance' in <code><a href="AnalyticalPopulationEstimateData.html">AnalyticalPopulationEstimateData</a></code>.</p></dd>

<dt>\(\widehat{CoVar}(\hat{\mu}^{(s,d_{1},v_{1})}, \hat{f}^{(s,d_{2},v_{2})})\)</dt>
<dd><p>The estimated covariance of means between the variable \(v_{1}\) in domain \(d_{1}\) and the variable \(v_{2}\) in domain \(d_{2}\) in stratum \(s\). 'MeanCovariance' in <code><a href="AnalyticalPopulationEstimateData.html">AnalyticalPopulationEstimateData</a></code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="AnalyticalPopulationEstimate.html">AnalyticalPopulationEstimate</a></code>, <code><a href="AggregateAnalyticalEstimate.html">AggregateAnalyticalEstimate</a></code>, <code><a href="ExtendAnalyticalSamplingFrameCoverage.html">ExtendAnalyticalSamplingFrameCoverage</a></code>, <code><a href="InterpolateAnalyticalDomainEstimates.html">InterpolateAnalyticalDomainEstimates</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="va">PSUsamplingParameters</span> <span class="op">&lt;-</span> <span class="fu">RstoxFDA</span><span class="fu">::</span><span class="fu"><a href="AssignPSUSamplingParameters.html">AssignPSUSamplingParameters</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                                       <span class="fu">RstoxFDA</span><span class="fu">::</span><span class="va"><a href="CatchLotterySamplingExample.html">CatchLotterySamplingExample</a></span>, </span></span>
<span class="r-in"><span>                                       <span class="fu">RstoxFDA</span><span class="fu">::</span><span class="va"><a href="CatchLotteryExample.html">CatchLotteryExample</a></span>, </span></span>
<span class="r-in"><span>                                       <span class="st">"serialnumber"</span>, <span class="st">"Haul"</span>, <span class="st">"MissingAtRandom"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">individualSamplingParameters</span> <span class="op">&lt;-</span>  <span class="fu">RstoxFDA</span><span class="fu">:::</span><span class="fu"><a href="ComputeIndividualSamplingParameters.html">ComputeIndividualSamplingParameters</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>                                       <span class="fu">RstoxFDA</span><span class="fu">::</span><span class="va"><a href="CatchLotteryExample.html">CatchLotteryExample</a></span>, <span class="st">"SRS"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IndividualAge"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co"># Estimate for the domain 'CountryVessel'                                      </span></span></span>
<span class="r-in"><span> <span class="va">psuEst</span> <span class="op">&lt;-</span> <span class="fu">RstoxFDA</span><span class="fu">:::</span><span class="fu"><a href="AnalyticalPSUEstimate.html">AnalyticalPSUEstimate</a></span><span class="op">(</span><span class="fu">RstoxFDA</span><span class="fu">::</span><span class="va"><a href="CatchLotteryExample.html">CatchLotteryExample</a></span>, </span></span>
<span class="r-in"><span>                                       <span class="va">individualSamplingParameters</span>, </span></span>
<span class="r-in"><span>                                       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IndividualRoundWeight"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                                       <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"IndividualAge"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">popEst</span> <span class="op">&lt;-</span> <span class="fu">RstoxFDA</span><span class="fu">:::</span><span class="fu"><a href="AnalyticalPopulationEstimate.html">AnalyticalPopulationEstimate</a></span><span class="op">(</span><span class="va">PSUsamplingParameters</span>, <span class="va">psuEst</span><span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span> <span class="co"># perform ration estimate, assigning total weights by 'CountryVessel'</span></span></span>
<span class="r-in"><span> <span class="va">ratioEst</span> <span class="op">&lt;-</span> <span class="fu">RstoxFDA</span><span class="fu">::</span><span class="fu">AnalyticalRatioEstimate</span><span class="op">(</span><span class="va">popEst</span>, </span></span>
<span class="r-in"><span>                                        <span class="fu">RstoxFDA</span><span class="fu">::</span><span class="va"><a href="CatchLotteryLandingExample.html">CatchLotteryLandingExample</a></span>, </span></span>
<span class="r-in"><span>                                        <span class="st">"IndividualRoundWeight"</span>, </span></span>
<span class="r-in"><span>                                        <span class="st">"CountryVessel"</span><span class="op">)</span></span></span>
<span class="r-in"><span> </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edvin Fuglebakk, Arne Johannes Holmin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

