<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute PSU Sampling Design Parameters — ComputePSUSamplingParameters • RstoxFDA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute PSU Sampling Design Parameters — ComputePSUSamplingParameters"><meta name="description" content="Compute sampling parameters for Primary Sampling Units in multi-stage sampling."><meta property="og:description" content="Compute sampling parameters for Primary Sampling Units in multi-stage sampling."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RstoxFDA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0-9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Stox-Analytical.html">StoX-Analytical-Estimates</a></li>
    <li><a class="dropdown-item" href="../articles/StoX-data-preparation.html">StoX FDA data preparation (baseline)</a></li>
    <li><a class="dropdown-item" href="../articles/Stox-FDA-overview.html">StoX Fisheries overview (report)</a></li>
    <li><a class="dropdown-item" href="../articles/stox-reca.html">StoX-Reca (analysis)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/StoXProject/RstoxFDA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Compute PSU Sampling Design Parameters</h1>
      <small class="dont-index">Source: <a href="https://github.com/StoXProject/RstoxFDA/blob/master/R/StoxAnalyticalBaselineFunctions.R" class="external-link"><code>R/StoxAnalyticalBaselineFunctions.R</code></a></small>
      <div class="d-none name"><code>ComputePSUSamplingParameters.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute sampling parameters for Primary Sampling Units in multi-stage sampling.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ComputePSUSamplingParameters</span><span class="op">(</span></span>
<span>  <span class="va">StoxBioticData</span>,</span>
<span>  DefinitionMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AdHocStoxBiotic"</span>, <span class="st">"ProportionalPoissonSampling"</span><span class="op">)</span>,</span>
<span>  SamplingUnitId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  StratificationColumns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  StratumName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  Quota <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  ExpectedSampleSize <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-stoxbioticdata">StoxBioticData<a class="anchor" aria-label="anchor" href="#arg-stoxbioticdata"></a></dt>
<dd><p><code><a href="https://rdrr.io/pkg/RstoxData/man/StoxBioticData.html" class="external-link">StoxBioticData</a></code> Sample data to construct design parameters from</p></dd>


<dt id="arg-definitionmethod">DefinitionMethod<a class="anchor" aria-label="anchor" href="#arg-definitionmethod"></a></dt>
<dd><p>'AdHocStoxBiotic' or 'ProportionalPoissonSampling'</p></dd>


<dt id="arg-samplingunitid">SamplingUnitId<a class="anchor" aria-label="anchor" href="#arg-samplingunitid"></a></dt>
<dd><p>name of column in 'StoxBioticData' that identifies the Primary Sampling Unit the design is constructed for.</p></dd>


<dt id="arg-stratificationcolumns">StratificationColumns<a class="anchor" aria-label="anchor" href="#arg-stratificationcolumns"></a></dt>
<dd><p>name of columns that are to be used to define Strata for sampling. (for DefinitionMethod 'AdHocStoxBiotic'). See <code><a href="PSUSamplingParametersData.html">PSUSamplingParametersData</a></code></p></dd>


<dt id="arg-stratumname">StratumName<a class="anchor" aria-label="anchor" href="#arg-stratumname"></a></dt>
<dd><p>name of the stratum sampling parameters are calculated for (for DefinitionMethod 'ProportionalPoissonSampling')</p></dd>


<dt id="arg-quota">Quota<a class="anchor" aria-label="anchor" href="#arg-quota"></a></dt>
<dd><p>expected total catch in sampling frame in kg (for DefinitionMethod 'ProportionalPoissonSampling')</p></dd>


<dt id="arg-expectedsamplesize">ExpectedSampleSize<a class="anchor" aria-label="anchor" href="#arg-expectedsamplesize"></a></dt>
<dd><p>the expected sample size for Possion sampling (for DefinitionMethod 'ProportionalPoissonSampling')</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code><a href="PSUSamplingParametersData.html">PSUSamplingParametersData</a></code></p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Computes Sampling Design Parameters from data, given some assumptions specified by the 'DefinitionMethod'.</p>
<p>Primary Sampling Units (the argument 'SamplingUnitId') may be identified by any categorical (character, factor) or ordinal (factor, integer) variable in 'StoxBioticData', that are associated with the 'Sample'-table
or any table above 'Sample' in the StoxBiotic-hierarchy.</p>
<p>If 'DefinitionMethod' is 'AdHocStoxBiotic', equal probability sampling with fixed sample size will be assumed withing strata, as well as
selection with replacement and complete response.
This is a reasonable approximation if within-strata sampling is approximately simple random selections,
the sample intensitiy is low (only a small fraction of the population is sampled),
and non-response is believed to be random. StratificationVariables may be any categorical or ordinal variables in 'StoxBioticData', that are associated with the 'Sample'-table
or any table above 'Sample' in the StoxBiotic-hierarchy, and strata will be defined as the combination of these variables.
Primary Sampling Units must be selected withing stratum, so the function will fail there are several strata in one PSU.</p>
<p>If 'DefinitionMethod' is 'ProportionalPoissonSampling', Unstratified (singe stratum) Poission sampling with selection probabilities
proportional to catch size is assumed. 'SamplingUnitId' must be a variable on the Haul table of 'StoxBioticData' for this option,
and the data must contain only one species (SpeciesCategory in 'StoxBioticData'). SelectionProbabilities are assigned
based on the total catch of the species in each haul. Specifically, for a haul \(i\); selectionprobabilites, \(p_{i}\) and inclusionprobabilities \(\pi_{i}\)
are calculated as:</p>
<p>$$p_{i}=\frac{w_{i}}{W}$$</p>
<p>$$\pi_{i}=1-(1-p_{i})^{n}$$</p>
<p>where:</p><ul><li><p>\(w_{i}\) is the sum of all catch weights in haul \(i\) ('CatchFractionWeight' on the 'Sample' table of 'StoxBioticData')</p></li>
<li><p>\(W\) is the expected total catch in the fishery (argument 'Quota')</p></li>
<li><p>\(n\) is the expected sample size (argument 'ExpectedSampleSize')</p></li>
</ul><p>If proportional poisson sampling was actually used to select the sampled records in 'StoxBioticData',
sampling parameters would have been obtained prior to sampling, and it is generally preferable to obtain these,
and import those via <code><a href="ReadPSUSamplingParameters.html">ReadPSUSamplingParameters</a></code>. Weight-records are sometimes corrected after
sampling parameters are calculated, and proper information about non-response can not be recalculated after the fact.</p>
<p>Proportional poisson sampling also allows the sampler to combine rigour and pragmatism, by varying sampling parameters
in the course of sample selection. For instance 'n' may be changed during the sampling period, if non-response
turns out to be higher than expected. Such flexibilities are not
provided by this function, and the approximation may be severely compromised, if such pragmatism is not accounted for.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ReadPSUSamplingParameters.html">ReadPSUSamplingParameters</a></code>, <code><a href="AddPsuStratificationVariables.html">AddPsuStratificationVariables</a></code>, <code><a href="AssignPSUSamplingParameters.html">AssignPSUSamplingParameters</a></code>, <code><a href="AnalyticalPopulationEstimate.html">AnalyticalPopulationEstimate</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="co"># parameters for simple random haul-selection, stratified by GearGroup</span></span></span>
<span class="r-in"><span> <span class="va">PSUparams</span> <span class="op">&lt;-</span> <span class="fu">ComputePSUSamplingParameters</span><span class="op">(</span><span class="fu">RstoxFDA</span><span class="fu">::</span><span class="va"><a href="StoxBioticDataExample.html">StoxBioticDataExample</a></span>, </span></span>
<span class="r-in"><span>  <span class="st">"AdHocStoxBiotic"</span>, </span></span>
<span class="r-in"><span>  <span class="st">"Haul"</span>, </span></span>
<span class="r-in"><span>  <span class="st">"GearGroup"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span> <span class="co"># parameters for haul selection proportional to catch size.</span></span></span>
<span class="r-in"><span> <span class="va">calculatedPps</span> <span class="op">&lt;-</span> <span class="fu">RstoxFDA</span><span class="fu">::</span><span class="fu">ComputePSUSamplingParameters</span><span class="op">(</span><span class="fu">RstoxFDA</span><span class="fu">::</span><span class="va"><a href="CatchLotteryExample.html">CatchLotteryExample</a></span>, </span></span>
<span class="r-in"><span>    <span class="st">"ProportionalPoissonSampling"</span>, </span></span>
<span class="r-in"><span>    <span class="st">"serialnumber"</span>, StratumName <span class="op">=</span> </span></span>
<span class="r-in"><span>    <span class="st">"Nordsjo"</span>, Quota <span class="op">=</span> <span class="fl">124</span><span class="op">*</span><span class="fl">1e6</span>, </span></span>
<span class="r-in"><span>    ExpectedSampleSize <span class="op">=</span> <span class="fl">110</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edvin Fuglebakk, Arne Johannes Holmin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

