<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Prepare data for R-ECA — prepRECA • RstoxFDA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare data for R-ECA — prepRECA"><meta name="description" content="Checks and reformats data in preparation for running with runRECA or RunRecaEstimate
 Not to be confused with PrepareRecaEstimate, which is primarily intended for including in Stox projects."><meta property="og:description" content="Checks and reformats data in preparation for running with runRECA or RunRecaEstimate
 Not to be confused with PrepareRecaEstimate, which is primarily intended for including in Stox projects."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RstoxFDA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0-9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Stox-Analytical.html">StoX-Analytical-Estimates</a></li>
    <li><a class="dropdown-item" href="../articles/StoX-data-preparation.html">StoX FDA data preparation (baseline)</a></li>
    <li><a class="dropdown-item" href="../articles/Stox-FDA-overview.html">StoX Fisheries overview (report)</a></li>
    <li><a class="dropdown-item" href="../articles/stox-reca.html">StoX-Reca (analysis)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/StoXProject/RstoxFDA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Prepare data for R-ECA</h1>
      <small class="dont-index">Source: <a href="https://github.com/StoXProject/RstoxFDA/blob/master/R/RecaWrap.R" class="external-link"><code>R/RecaWrap.R</code></a></small>
      <div class="d-none name"><code>prepRECA.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Checks and reformats data in preparation for running with <code><a href="runRECA.html">runRECA</a></code> or <code><a href="RunRecaEstimate.html">RunRecaEstimate</a></code>
 Not to be confused with <code><a href="PrepareRecaEstimate.html">PrepareRecaEstimate</a></code>, which is primarily intended for including in Stox projects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prepRECA</span><span class="op">(</span></span>
<span>  <span class="va">samples</span>,</span>
<span>  <span class="va">landings</span>,</span>
<span>  <span class="va">fixedEffects</span>,</span>
<span>  <span class="va">randomEffects</span>,</span>
<span>  carEffect <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  neighbours <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nFish <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ageError <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  minAge <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxAge <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxLength <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lengthResolution <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  testMax <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  date <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  month <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quarter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hatchDay <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  interaction <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>data.table() with samples, each row corresponding to one sampled fish. Contains columns:</p><dl><dt>catchId</dt>
<dd><p>Column identifying the catch that the sample was taken from. Typically a haul or a landing.</p></dd>

 <dt>sampleId</dt>
<dd><p>Column identifying the sample. If only one sample is taken for each catch. This can be set equal to catchId</p></dd>

 <dt>date</dt>
<dd><p>POSIXct() Date of catch</p></dd>

 <dt>Age</dt>
<dd><p>integer() Age of fish</p></dd>

 <dt>Length</dt>
<dd><p>numeric() Length of fish in cm. Must be complete (no NAs)</p></dd>

 <dt>Weight</dt>
<dd><p>numeric() Weight of fish in kg. Fish with missing values will not be included in Weight-given-length model.</p></dd>

 <dt>Otolithtype</dt>
<dd><p>integer(), optional, Code identifying stock-classification, may contain integers 1,2,4 and 5.</p></dd>

 <dt>...</dt>
<dd><p>Additional columns which may be used as covariates as covariates. Type of covariate must be sepcified in 'fixedEffects', 'randomEffects' or 'carEffect'</p></dd>


</dl></dd>


<dt id="arg-landings">landings<a class="anchor" aria-label="anchor" href="#arg-landings"></a></dt>
<dd><p>data.table() with total landings, each row corresponding to one cell. Contains columns:</p><dl><dt>LiveWeightKG</dt>
<dd><p>numeric(). Total landings (Live/Round weight in Kg) for the cell</p></dd>

 <dt>...</dt>
<dd><p>Additional columns which may be used as covariates. Covariates in landings define each cell. Type of covariate must be sepcified in 'fixedEffects', 'randomEffects' or 'carEffect'</p></dd>


</dl></dd>


<dt id="arg-fixedeffects">fixedEffects<a class="anchor" aria-label="anchor" href="#arg-fixedeffects"></a></dt>
<dd><p>character() vector specifying fixed effects. Corresponding columns must exists in samples and landings.</p></dd>


<dt id="arg-randomeffects">randomEffects<a class="anchor" aria-label="anchor" href="#arg-randomeffects"></a></dt>
<dd><p>character() vector specifying random effects. Corresponding columns must exists samples (may also exist in landings).</p></dd>


<dt id="arg-careffect">carEffect<a class="anchor" aria-label="anchor" href="#arg-careffect"></a></dt>
<dd><p>character() specifying a random effect with conditional autoregressive coefficient. Corresponding columns must exists samples (may also exist in landings).</p></dd>


<dt id="arg-neighbours">neighbours<a class="anchor" aria-label="anchor" href="#arg-neighbours"></a></dt>
<dd><p>list() specifying the neighbourhood-structure for the carEffect. neighbours[a] should provide a vector of neighbours to a. May be NULL of no carEffect is used.</p></dd>


<dt id="arg-nfish">nFish<a class="anchor" aria-label="anchor" href="#arg-nfish"></a></dt>
<dd><p>data.table() with the columns 'sampleId' and 'count', specifying the number of fish in the part of the catch that each sample was taken from. Not always needed. See details.</p></dd>


<dt id="arg-ageerror">ageError<a class="anchor" aria-label="anchor" href="#arg-ageerror"></a></dt>
<dd><p>matrix() specifying the probability of read age (rows), given true age (columns). Row and column names specify the ages. If NULL, a unit matrix is assumed (No error in age reading).</p></dd>


<dt id="arg-minage">minAge<a class="anchor" aria-label="anchor" href="#arg-minage"></a></dt>
<dd><p>lowest age to include in model. If NULL, minimal age in samples is used. Age range must match any age error matrix provided (ageError)</p></dd>


<dt id="arg-maxage">maxAge<a class="anchor" aria-label="anchor" href="#arg-maxage"></a></dt>
<dd><p>highest age to include in model. If NULL, maximal age in samples is used. Age range must match any age error matrix provided (ageError)</p></dd>


<dt id="arg-maxlength">maxLength<a class="anchor" aria-label="anchor" href="#arg-maxlength"></a></dt>
<dd><p>longest length to include in model.  If NULL, maximal length in samples is used.</p></dd>


<dt id="arg-lengthresolution">lengthResolution<a class="anchor" aria-label="anchor" href="#arg-lengthresolution"></a></dt>
<dd><p>desired resolution for length groups. If NULL minimal difference in first testMax records are used.</p></dd>


<dt id="arg-testmax">testMax<a class="anchor" aria-label="anchor" href="#arg-testmax"></a></dt>
<dd><p>The largest number of record to inspect for deriving lengthResolution.</p></dd>


<dt id="arg-date">date<a class="anchor" aria-label="anchor" href="#arg-date"></a></dt>
<dd><p>POSIXct() vector, matching the number of rows in 'landings', date of catch, see details.</p></dd>


<dt id="arg-month">month<a class="anchor" aria-label="anchor" href="#arg-month"></a></dt>
<dd><p>integer() vector, matching the number of rows in 'landings', month of catch (1 for January, etc.), see details.</p></dd>


<dt id="arg-quarter">quarter<a class="anchor" aria-label="anchor" href="#arg-quarter"></a></dt>
<dd><p>integer() vector, vector, matching the number of rows in 'landings', quarter of catch (1 for Q1, etc.), see details.</p></dd>


<dt id="arg-hatchday">hatchDay<a class="anchor" aria-label="anchor" href="#arg-hatchday"></a></dt>
<dd><p>integer(), encoding the day of the year when fish is consider to transition from one age to the next.</p></dd>


<dt id="arg-interaction">interaction<a class="anchor" aria-label="anchor" href="#arg-interaction"></a></dt>
<dd><p>character vector specifying effects that should be included in interaction term. Must correspond to effects specified in parameters 'fixedEffects', 'randomEffects', or 'carEffect'</p><dl><dt>sampleID</dt>
<dd><p>Column idenitfying the sample, defined as for 'samples'</p></dd>

 <dt>count</dt>
<dd><p>Estimated number of fish in the part of the catch the sample was taken from</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code><a href="RecaData.html">RecaData</a></code> Data and some data related parameters prepared for running Reca.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The cell definition is specified by 'landings'.
 The type of covariates are specified in fixedEffects, randomEffects and carEffect.
 All fixed effects, as well as any car-effect, must be included in the cell definition.
 All covariates must occur in samples.</p>
<p>The parameters 'date', 'month', and 'quarter' are used to set the temporal resolution for catch at age prediction.
 Provide exactly one of these, and set the other ones to NULL.
 Temporal resolution need not match any temporal covariate used.
 One can for example run with month, even if Quarter is a covariate in the model.
 Note that resolution is sensitive to data volume. If you get errors in prediction with E_p(a) = nan,
 consider trying with quarter.</p>
<p>neighbours must be symetric, so that b %in% neighbours[a], implies a %in% neighbours[b]</p>
<p>nfish is only needed when several samples may be taken from the same catch.
 If these are stratified in any way (e.g. pre-sorting by size or sex), an estimate of strata sizes must be given (column 'count'), for each sample (column 'sampleId').
 If these are replicate samples from the same selection frame, an estimate of the total catch may be given.</p>
<p>If the column 'Otolithtype' is provided, data is prepared for running stock-splitting analysis.
 Support 4 otolithtypes, where type 1 and 2 correspond to one stock, and type 4 and 5 correspond to another
 review documentation for <code>eca.estimate</code> and <code>eca.predict</code>,
 for information about how to configure running of this stock splitting, and how to interpret results.</p>
<p>output GlobalParameters: While outputs AgeLength, WeightLength and Landings are complete and ready for R-ECA runs.
 This function populates the list of GlobalParameters only partially. Run parameters have to be added afterwards.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">catchsamples</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">catchsamples</span><span class="op">$</span><span class="va">catchId</span> <span class="op">&lt;-</span> <span class="va">catchsamples</span><span class="op">$</span><span class="va">LEid</span></span></span>
<span class="r-in"><span> <span class="va">catchsamples</span><span class="op">$</span><span class="va">sampleId</span> <span class="op">&lt;-</span> <span class="va">catchsamples</span><span class="op">$</span><span class="va">SAid</span></span></span>
<span class="r-in"><span> <span class="va">catchsamples</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;-</span> <span class="va">catchsamples</span><span class="op">$</span><span class="va">LEdate</span></span></span>
<span class="r-in"><span> <span class="va">catchsamples</span><span class="op">$</span><span class="va">Metier5</span> <span class="op">&lt;-</span> <span class="va">catchsamples</span><span class="op">$</span><span class="va">LEmetier5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">landings</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">landings</span><span class="op">$</span><span class="va">LiveWeightKG</span> <span class="op">&lt;-</span> <span class="va">landings</span><span class="op">$</span><span class="va">OfficialLandingsWeight</span></span></span>
<span class="r-in"><span> <span class="va">landings</span><span class="op">$</span><span class="va">Metier5</span> <span class="op">&lt;-</span> <span class="va">landings</span><span class="op">$</span><span class="va">FishingActivityCategoryEuropeanLvl5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># inspect data</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="rEcaDataReport.html">rEcaDataReport</a></span><span class="op">(</span><span class="va">catchsamples</span>, <span class="va">landings</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Metier5"</span>, <span class="st">"VDencrCode"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Metier5 LiveWeightKG LiveWeightCumFraction NVDencrCode Ndate Ncatch Nsample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;char&gt;        &lt;int&gt;                 &lt;num&gt;       &lt;num&gt; &lt;num&gt;  &lt;num&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1: OTB_DEF     39822917             0.4175925           1     1      1       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2: LLS_DEF     26807800             0.6987055          34    16     34      35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3: SSC_DEF     14299890             0.8486575          29    23     29      29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:  LX_DEF      9328848             0.9464820           0     0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5: GNS_DEF      2754654             0.9753680          17     9     17      17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6: LLD_DEF      2063217             0.9970034           0     0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7: PTB_DEF       118092             0.9982417           0     0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8: LHM_DEF        83410             0.9991164           0     0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9: OTM_DEF        63339             0.9997806           0     0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10: FPO_DEF         9051             0.9998755           0     0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:  PS_DEF         5267             0.9999307           0     0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12: OTT_DEF         5155             0.9999848           0     0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13: GND_DEF         1202             0.9999974           0     0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14: MIS_DEF          251             1.0000000           0     0      0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Nage Nweight Nlength</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;num&gt;   &lt;num&gt;   &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:    29      29      29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:   962     962     962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:   721     721     721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:     0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:   338     338     338</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:     0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:     0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:     0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:     0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:     0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:     0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:     0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:     0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:     0       0       0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># define sampling frame</span></span></span>
<span class="r-in"><span> <span class="va">landings</span> <span class="op">&lt;-</span> <span class="va">landings</span><span class="op">[</span><span class="va">landings</span><span class="op">$</span><span class="va">Metier5</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GNS_DEF"</span>, <span class="st">"LLS_DEF"</span>, <span class="st">"LX_DEF"</span>, <span class="st">"SSC_DEF"</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span> <span class="va">landings</span> <span class="op">&lt;-</span> <span class="va">landings</span><span class="op">[</span><span class="va">landings</span><span class="op">$</span><span class="va">Area</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"27.2.a.2"</span>, <span class="st">"27.1.b"</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span> <span class="va">catchsamples</span> <span class="op">&lt;-</span> <span class="va">catchsamples</span><span class="op">[</span><span class="va">catchsamples</span><span class="op">$</span><span class="va">Metier5</span> <span class="op">!=</span> <span class="st">"OTB_DEF"</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># merge gear groups</span></span></span>
<span class="r-in"><span> <span class="va">landings</span><span class="op">[</span><span class="va">landings</span><span class="op">$</span><span class="va">Metier5</span> <span class="op">==</span> <span class="st">"LX_DEF"</span>, <span class="st">"Metier5"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"LSS_LX_DEF"</span></span></span>
<span class="r-in"><span> <span class="va">landings</span><span class="op">[</span><span class="va">landings</span><span class="op">$</span><span class="va">Metier5</span> <span class="op">==</span> <span class="st">"LLS_DEF"</span>, <span class="st">"Metier5"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"LSS_LX_DEF"</span></span></span>
<span class="r-in"><span> <span class="va">catchsamples</span><span class="op">[</span><span class="va">catchsamples</span><span class="op">$</span><span class="va">Metier5</span> <span class="op">==</span> <span class="st">"LX_DEF"</span>, <span class="st">"Metier5"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"LSS_LX_DEF"</span></span></span>
<span class="r-in"><span> <span class="va">catchsamples</span><span class="op">[</span><span class="va">catchsamples</span><span class="op">$</span><span class="va">Metier5</span> <span class="op">==</span> <span class="st">"LLS_DEF"</span>, <span class="st">"Metier5"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"LSS_LX_DEF"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># inspect data</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="rEcaDataReport.html">rEcaDataReport</a></span><span class="op">(</span><span class="va">catchsamples</span>, <span class="va">landings</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Metier5"</span>, <span class="st">"VDencrCode"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Metier5 LiveWeightKG LiveWeightCumFraction NVDencrCode Ndate Ncatch</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        &lt;char&gt;        &lt;int&gt;                 &lt;num&gt;       &lt;int&gt; &lt;int&gt;  &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1: LSS_LX_DEF     31558580             0.7190532          34    16     34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:    SSC_DEF      9827412             0.9429679          29    23     29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:    GNS_DEF      2503085             1.0000000          17     9     17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Nsample  Nage Nweight Nlength</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      &lt;int&gt; &lt;int&gt;   &lt;int&gt;   &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:      35   962     962     962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:      29   721     721     721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:      17   338     338     338</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">#attempt prepRECA, gives error</span></span></span>
<span class="r-in"><span> <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="fu">prepRECA</span><span class="op">(</span><span class="va">catchsamples</span>,</span></span>
<span class="r-in"><span>   <span class="va">landings</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Metier5"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>   quarter <span class="op">=</span> <span class="va">landings</span><span class="op">$</span><span class="va">Quarter</span><span class="op">)</span> <span class="co"># \dontrun{}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">#get catch count estimates</span></span></span>
<span class="r-in"><span> <span class="va">meanWeights</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>meanW<span class="op">=</span><span class="va">catchsamples</span><span class="op">$</span><span class="va">Weight</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sampleId<span class="op">=</span><span class="va">catchsamples</span><span class="op">$</span><span class="va">sampleId</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co">#total weight is unique for sampleID, hence the FUN=mean</span></span></span>
<span class="r-in"><span> <span class="va">totalWeights</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>totalW<span class="op">=</span><span class="va">catchsamples</span><span class="op">$</span><span class="va">SAtotalWtLive</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sampleId<span class="op">=</span><span class="va">catchsamples</span><span class="op">$</span><span class="va">sampleId</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">nFish</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">totalWeights</span>, <span class="va">meanWeights</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">nFish</span><span class="op">$</span><span class="va">count</span> <span class="op">&lt;-</span> <span class="va">nFish</span><span class="op">$</span><span class="va">totalW</span> <span class="op">/</span> <span class="va">nFish</span><span class="op">$</span><span class="va">meanW</span></span></span>
<span class="r-in"><span> <span class="va">nFish</span> <span class="op">&lt;-</span> <span class="va">nFish</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sampleId"</span>, <span class="st">"count"</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co">#prepRECA (produce recaData as in data(recaDataExample))</span></span></span>
<span class="r-in"><span> <span class="va">recaDataExample</span> <span class="op">&lt;-</span> <span class="fu">prepRECA</span><span class="op">(</span><span class="va">catchsamples</span>,</span></span>
<span class="r-in"><span>   <span class="va">landings</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Metier5"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>   nFish <span class="op">=</span> <span class="va">nFish</span>,</span></span>
<span class="r-in"><span>   quarter <span class="op">=</span> <span class="va">landings</span><span class="op">$</span><span class="va">Quarter</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edvin Fuglebakk, Arne Johannes Holmin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

