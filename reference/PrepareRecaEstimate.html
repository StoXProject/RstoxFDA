<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Performs data checks and data conversions,
and stores some data-related parameters in preparation for running
ParameterizeRecaModels."><title>Prepare data for Reca. — PrepareRecaEstimate • RstoxFDA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare data for Reca. — PrepareRecaEstimate"><meta property="og:description" content="Performs data checks and data conversions,
and stores some data-related parameters in preparation for running
ParameterizeRecaModels."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">RstoxFDA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0-9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/StoX-data-preparation.html">StoX FDA data preparation (baseline)</a>
    <a class="dropdown-item" href="../articles/Stox-FDA-overview.html">StoX Fisheries overview (report)</a>
    <a class="dropdown-item" href="../articles/stox-reca.html">StoX-Reca (analysis)</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/StoXProject/RstoxFDA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Prepare data for Reca.</h1>
      <small class="dont-index">Source: <a href="https://github.com/StoXProject/RstoxFDA/blob/HEAD/R/StoxAnalysisFunctions.R" class="external-link"><code>R/StoxAnalysisFunctions.R</code></a></small>
      <div class="d-none name"><code>PrepareRecaEstimate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs data checks and data conversions,
and stores some data-related parameters in preparation for running
<code><a href="ParameterizeRecaModels.html">ParameterizeRecaModels</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PrepareRecaEstimate</span><span class="op">(</span></span>
<span>  <span class="va">StoxBioticData</span>,</span>
<span>  <span class="va">StoxLandingData</span>,</span>
<span>  FixedEffects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  RandomEffects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  UseCarEffect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  CarEffect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">CarNeighbours</span>,</span>
<span>  UseAgingError <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">AgeErrorMatrix</span>,</span>
<span>  UseStockSplitting <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  UseStockSplittingError <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">StockSplittingParameters</span>,</span>
<span>  CellEffect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Off"</span>, <span class="st">"All"</span><span class="op">)</span>,</span>
<span>  MinAge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  MaxAge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  MaxLength <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  LengthResolution <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  HatchDay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>StoxBioticData</dt>
<dd><p><code><a href="https://rdrr.io/pkg/RstoxData/man/StoxBioticData.html" class="external-link">StoxBioticData</a></code> data with samples from fisheries
and approriate columns appended for specifying cells. See details.</p></dd>


<dt>StoxLandingData</dt>
<dd><p><code><a href="https://rdrr.io/pkg/RstoxData/man/StoxLandingData.html" class="external-link">StoxLandingData</a></code> data with landings from fisheries
and approriate columns appended for specifying cells. See details.</p></dd>


<dt>FixedEffects</dt>
<dd><p>optional, vector identifying column names that should be treated as fixed effects. See details</p></dd>


<dt>RandomEffects</dt>
<dd><p>optional, vector identifying column names that should be treated as random effects. See details</p></dd>


<dt>UseCarEffect</dt>
<dd><p>if TRUE, CAR-effect (conditional autoregressive effect) will be used.</p></dd>


<dt>CarEffect</dt>
<dd><p>optional, character identifying the column name that should be treated as CAR-effect.
Mandatory if 'UseCarEffect' is TRUE.</p></dd>


<dt>CarNeighbours</dt>
<dd><p><code><a href="CarNeighbours.html">CarNeighbours</a></code>, mandatory if 'carEffect' is given.
Identifies which values of the carEffect are to be considered as neighbours.</p></dd>


<dt>UseAgingError</dt>
<dd><p>If TRUE, aging, error parameters will be incorporated in the models.</p></dd>


<dt>AgeErrorMatrix</dt>
<dd><p><code><a href="AgeErrorMatrix.html">AgeErrorMatrix</a></code>, optional, specifies the probabilities of misreading ages.
mandatory if UseAgingError is TRUE.</p></dd>


<dt>UseStockSplitting</dt>
<dd><p>If TRUE, models will be condigured to provide estimates for each of two stocks based on otholitt-typing. See <code><a href="StockSplittingParameters.html">StockSplittingParameters</a></code>.</p></dd>


<dt>UseStockSplittingError</dt>
<dd><p>If TRUE, the model for error in stock classification (otolithtypes) will be applied.</p></dd>


<dt>StockSplittingParameters</dt>
<dd><p>Parameters for stock splitting. Mandatory if 'UseStockSplitting' is TRUE. May be obtained with <code><a href="DefineStockSplittingParameters.html">DefineStockSplittingParameters</a></code>.</p></dd>


<dt>CellEffect</dt>
<dd><p>Configures the cell effect. Defaults to Off. If 'All', an interaction term will be added with all covariates that in the cell (whether they are fixed or random effects).
Any CAR-effect is always included in the cell effect.</p></dd>


<dt>MinAge</dt>
<dd><p>optional, must match dimensions of any 'AgeErrorMatrix'.
If not provided it will be derived from data.</p></dd>


<dt>MaxAge</dt>
<dd><p>optional, must match dimensions of any 'AgeErrorMatrix'.
If not provided it will be derived from data.</p></dd>


<dt>MaxLength</dt>
<dd><p>optional, maximal fish length in data in cm.
If not provided it will be derived from data.</p></dd>


<dt>LengthResolution</dt>
<dd><p>optional, resolution for length measurements in cm.
If not provided modal value from data is used.</p></dd>


<dt>HatchDay</dt>
<dd><p>defaults to Defaults to 1.
encoding the day of the year when fish is consider to transition from one age to the next. 1 represents Jan 1st.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code><a href="RecaData.html">RecaData</a></code> Data prepared for running Reca.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Parameters are obtained for 'cells' using <code><a href="ParameterizeRecaModels.html">ParameterizeRecaModels</a></code>
and and applied to landings-data when predicting total catch-at-age using <code><a href="RunRecaModels.html">RunRecaModels</a></code>.</p><div class="section">
<h3 id="cells">Cells<a class="anchor" aria-label="anchor" href="#cells"></a></h3>


<p>Reca conceptually decomposes a fishery into cells. Parameters are estimated for each cell,
and later total catch at age is predicted for each cell. Cells must therefore be defined for
both the census of landings, and for the samples.</p>
<p>'Cells' are defined by all effects / covariates that are specified for both 'StoxLandingData' and 'StoxBioticData'
(all effects are specified by one of the arguments: 'FixedEffects', 'RandomEffects', and 'CarEffect').
Any variable that are to be included in
the cell definition must always be observed (not containing NAs)
and be coded coherently (the same coding system) in both 'StoxBioticData' and 'StoxLandingData'.</p>
</div>

<div class="section">
<h3 id="covariates">Covariates<a class="anchor" aria-label="anchor" href="#covariates"></a></h3>


<p>Only effects that are part of the cell definition may be specified as 'Fixed effect' or 'CAR effect'.
For fixed effect all values / levels of the effect must be sampled.
For CAR effect, the cell or neighbouring cells (as defined by 'CarNeighbours') must be sampled</p>
<p>Any variable in samples 'StoxBioticData' may be included as a random effect as long as it is always observed
(not containing NAs).</p>
<p>A random effect identifying haul / landing is always included in Reca. Do not add haul-identifiers as covariates.</p>
</div>

<div class="section">
<h3 id="stock-splitting">Stock splitting<a class="anchor" aria-label="anchor" href="#stock-splitting"></a></h3>


<p>The option UseStockSplitting requires that a Variable 'otolithtype' is added to
the table 'Individual' in StoxBioticData.
This is developed for splitting coastal cod from atlantic cod, and that is reflected in the Reca documentation,
but this is abstracted in StoX, so that other stocks may be encoded to fit the analysis.
For some cases it may even be extended to other domains defined for individual fish.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ReportFdaSampling.html">ReportFdaSampling</a></code> for inspecting the data availability for potential
cell definitions.
<code><a href="ParameterizeRecaModels.html">ParameterizeRecaModels</a></code>,
and <code><a href="RunRecaModels.html">RunRecaModels</a></code> for parameterising and running the Reca-analysis.
<code><a href="https://rdrr.io/pkg/RstoxBase/man/DefineStratumPolygon.html" class="external-link">DefineStratumPolygon</a></code>,
<code><a href="AddStratumStoxBiotic.html">AddStratumStoxBiotic</a></code>,
and <code><a href="AddStratumStoxLanding.html">AddStratumStoxLanding</a></code> for making 'Stratum' part of the cell definition,
and #'  <code><a href="DefineCarNeighbours.html">DefineCarNeighbours</a></code>, for maing 'Stratum' available as a CAR-effect
<code><a href="DefinePeriod.html">DefinePeriod</a></code>,
<code><a href="AddPeriodStoxBiotic.html">AddPeriodStoxBiotic</a></code>,
and <code><a href="AddPeriodStoxLanding.html">AddPeriodStoxLanding</a></code> for making 'Period' part of the cell definition.
#'  <code><a href="https://rdrr.io/pkg/RstoxData/man/DefineTranslation.html" class="external-link">DefineTranslation</a></code>,
<code><a href="AddGearGroupStoxBiotic.html">AddGearGroupStoxBiotic</a></code>,
and <code><a href="AddGearGroupStoxLanding.html">AddGearGroupStoxLanding</a></code> for making 'GearGroup' part of the cell definition.
<code><a href="DefineAgeErrorMatrix.html">DefineAgeErrorMatrix</a></code> for making an age-error matrix available for the Reca-analysis.
<code><a href="DefineStockSplittingParameters.html">DefineStockSplittingParameters</a></code> for configuring stock-splitting parameters,
and <code><a href="https://rdrr.io/pkg/RstoxData/man/AddToStoxBiotic.html" class="external-link">AddToStoxBiotic</a></code> for adding otolith-type to samples for stock-splitting analysis.</p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Arne Johannes Holmin, Edvin Fuglebakk.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

