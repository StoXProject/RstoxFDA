<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Prepare data for Reca. — PrepareRecaEstimate • RstoxFDA</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare data for Reca. — PrepareRecaEstimate"><meta property="og:description" content="Performs data checks and data conversions,
and stores some data-related parameters in preparation for running
ParameterizeRecaModels."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RstoxFDA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/StoX-data-preparation.html">StoX FDA data preparation (baseline)</a>
    </li>
    <li>
      <a href="../articles/Stox-FDA-overview.html">StoX Fisheries overview (report)</a>
    </li>
    <li>
      <a href="../articles/stox-reca.html">StoX-Reca (analysis)</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/StoXProject/RstoxFDA/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prepare data for Reca.</h1>
    <small class="dont-index">Source: <a href="https://github.com/StoXProject/RstoxFDA/blob/HEAD/R/StoxAnalysisFunctions.R" class="external-link"><code>R/StoxAnalysisFunctions.R</code></a></small>
    <div class="hidden name"><code>PrepareRecaEstimate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs data checks and data conversions,
and stores some data-related parameters in preparation for running
<code><a href="ParameterizeRecaModels.html">ParameterizeRecaModels</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">PrepareRecaEstimate</span><span class="op">(</span></span>
<span>  <span class="va">StoxBioticData</span>,</span>
<span>  <span class="va">StoxLandingData</span>,</span>
<span>  FixedEffects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  RandomEffects <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  UseCarEffect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  CarEffect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">CarNeighbours</span>,</span>
<span>  UseAgingError <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">AgeErrorMatrix</span>,</span>
<span>  UseStockSplitting <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  UseStockSplittingError <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">StockSplittingParameters</span>,</span>
<span>  CellEffect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Off"</span>, <span class="st">"All"</span><span class="op">)</span>,</span>
<span>  MinAge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  MaxAge <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  MaxLength <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  LengthResolution <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  HatchDay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>StoxBioticData</dt>
<dd><p><code><a href="https://rdrr.io/pkg/RstoxData/man/StoxBioticData.html" class="external-link">StoxBioticData</a></code> data with samples from fisheries
and approriate columns appended for specifying cells. See details.</p></dd>


<dt>StoxLandingData</dt>
<dd><p><code><a href="https://rdrr.io/pkg/RstoxData/man/StoxLandingData.html" class="external-link">StoxLandingData</a></code> data with landings from fisheries
and approriate columns appended for specifying cells. See details.</p></dd>


<dt>FixedEffects</dt>
<dd><p>optional, vector identifying column names that should be treated as fixed effects. See details</p></dd>


<dt>RandomEffects</dt>
<dd><p>optional, vector identifying column names that should be treated as random effects. See details</p></dd>


<dt>UseCarEffect</dt>
<dd><p>if TRUE, CAR-effect (conditional autoregressive effect) will be used.</p></dd>


<dt>CarEffect</dt>
<dd><p>optional, character identifying the column name that should be treated as CAR-effect.
Mandatory if 'UseCarEffect' is TRUE.</p></dd>


<dt>CarNeighbours</dt>
<dd><p><code><a href="CarNeighbours.html">CarNeighbours</a></code>, mandatory if 'carEffect' is given.
Identifies which values of the carEffect are to be considered as neighbours.</p></dd>


<dt>UseAgingError</dt>
<dd><p>If TRUE, aging, error parameters will be incorporated in the models.</p></dd>


<dt>AgeErrorMatrix</dt>
<dd><p><code><a href="AgeErrorMatrix.html">AgeErrorMatrix</a></code>, optional, specifies the probabilities of misreading ages.
mandatory if UseAgingError is TRUE.</p></dd>


<dt>UseStockSplitting</dt>
<dd><p>If TRUE, models will be condigured to provide estimates for each of two stocks based on otholitt-typing. See <code><a href="StockSplittingParameters.html">StockSplittingParameters</a></code>.</p></dd>


<dt>UseStockSplittingError</dt>
<dd><p>If TRUE, the model for error in stock classification (otolithtypes) will be applied.</p></dd>


<dt>StockSplittingParameters</dt>
<dd><p>Parameters for stock splitting. Mandatory if 'UseStockSplitting' is TRUE. May be obtained with <code><a href="DefineStockSplittingParameters.html">DefineStockSplittingParameters</a></code>.</p></dd>


<dt>CellEffect</dt>
<dd><p>Configures the cell effect. If 'All', an interaction term will be added with all covariates that in the cell (whether they are fixed or random effects).
Any CAR-effect is always included in the cell effect.</p></dd>


<dt>MinAge</dt>
<dd><p>optional, must match dimensions of any 'AgeErrorMatrix'.
If not provided it will be derived from data.</p></dd>


<dt>MaxAge</dt>
<dd><p>optional, must match dimensions of any 'AgeErrorMatrix'.
If not provided it will be derived from data.</p></dd>


<dt>MaxLength</dt>
<dd><p>optional, maximal fish length in data in cm.
If not provided it will be derived from data.</p></dd>


<dt>LengthResolution</dt>
<dd><p>optional, resolution for length measurements in cm.
If not provided modal value from data is used.</p></dd>


<dt>HatchDay</dt>
<dd><p>defaults to 1 representing Jan 1st.
encoding the day of the year when fish is consider to transition from one age to the next.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code><a href="recaData.html">RecaData</a></code> Data prepared for running Reca.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Parameters are obtained for 'cells' using <code><a href="ParameterizeRecaModels.html">ParameterizeRecaModels</a></code>
and and applied to landings-data when predicting total catch-at-age using <code><a href="RunRecaModels.html">RunRecaModels</a></code>.</p><div class="section">
<h3 id="cells">Cells<a class="anchor" aria-label="anchor" href="#cells"></a></h3>


<p>Reca conceptually decomposes a fishery into cells. Parameters are estimated for each cell,
and later total catch at age is predicted for each cell. Cells must therefore be defined for
both the census of landings, and for the samples.</p>
<p>'Cells' are defined by all effects / covariates that are specified for both 'StoxLandingData' and 'StoxBioticData'
(all effects are specified by one of the arguments: 'FixedEffects', 'RandomEffects', and 'CarEffect').
Any variable that are to be included in
the cell definition must always be observed (not containing NAs)
and be coded coherently (the same coding system) in both 'StoxBioticData' and 'StoxLandingData'.</p>
</div>

<div class="section">
<h3 id="covariates">Covariates<a class="anchor" aria-label="anchor" href="#covariates"></a></h3>


<p>Only effects that are part of the cell definition may be specified as 'Fixed effect' or 'CAR effect'.
For fixed effect all values / levels of the effect must be sampled.
For CAR effect, the cell or neighbouring cells (as defined by 'CarNeighbours') must be sampled</p>
<p>Any variable in samples 'StoxBioticData' may be included as a random effect as long as it is always observed
(not containing NAs).</p>
<p>A random effect identifying haul / landing is always included in Reca. Do not add haul-identifiers as covariates.</p>
</div>

<div class="section">
<h3 id="stock-splitting">Stock splitting<a class="anchor" aria-label="anchor" href="#stock-splitting"></a></h3>


<p>The option UseStockSplitting requires that a Variable 'otolithtype' is added to
the table 'Individual' in StoxBioticData.
This is developed for splitting coastal cod from atlantic cod, and that is reflected in the Reca documentation,
but this is abstracted in StoX, so that other stocks may be encoded to fit the analysis.
For some cases it may even be extended to other domains defined for individual fish.</p>
</div>

    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ReportFdaSampling.html">ReportFdaSampling</a></code> for inspecting the data availability for potential
cell definitions.
<code><a href="ParameterizeRecaModels.html">ParameterizeRecaModels</a></code>,
and <code><a href="RunRecaModels.html">RunRecaModels</a></code> for parameterising and running the Reca-analysis.
<code><a href="https://rdrr.io/pkg/RstoxBase/man/DefineStratumPolygon.html" class="external-link">DefineStratumPolygon</a></code>,
<code><a href="AddStratumStoxBiotic.html">AddStratumStoxBiotic</a></code>,
and <code><a href="AddStratumStoxLanding.html">AddStratumStoxLanding</a></code> for making 'Stratum' part of the cell definition,
and #'  <code><a href="DefineCarNeighbours.html">DefineCarNeighbours</a></code>, for maing 'Stratum' available as a CAR-effect
<code><a href="DefinePeriod.html">DefinePeriod</a></code>,
<code><a href="AddPeriodStoxBiotic.html">AddPeriodStoxBiotic</a></code>,
and <code><a href="AddPeriodStoxLanding.html">AddPeriodStoxLanding</a></code> for making 'Period' part of the cell definition.
#'  <code><a href="https://rdrr.io/pkg/RstoxData/man/DefineTranslation.html" class="external-link">DefineTranslation</a></code>,
<code><a href="AddGearGroupStoxBiotic.html">AddGearGroupStoxBiotic</a></code>,
and <code><a href="AddGearGroupStoxLanding.html">AddGearGroupStoxLanding</a></code> for making 'GearGroup' part of the cell definition.
<code><a href="DefineAgeErrorMatrix.html">DefineAgeErrorMatrix</a></code> for making an age-error matrix available for the Reca-analysis.
<code><a href="DefineStockSplittingParameters.html">DefineStockSplittingParameters</a></code> for configuring stock-splitting parameters,
and <code><a href="https://rdrr.io/pkg/RstoxData/man/AddToStoxBiotic.html" class="external-link">AddToStoxBiotic</a></code> for adding otolith-type to samples for stock-splitting analysis.</p>
<p>Other Reca functions: 
<code><a href="AddStratumStoxLanding.html">AddStratumStoxLanding</a>()</code>,
<code><a href="DefineAgeErrorMatrix.html">DefineAgeErrorMatrix</a>()</code>,
<code><a href="DefineStockSplittingParameters.html">DefineStockSplittingParameters</a>()</code>,
<code><a href="ParameterizeRecaModels.html">ParameterizeRecaModels</a>()</code>,
<code><a href="ReportRecaCatchAtAgeCovariance.html">ReportRecaCatchAtAgeCovariance</a>()</code>,
<code><a href="ReportRecaCatchAtAge.html">ReportRecaCatchAtAge</a>()</code>,
<code><a href="ReportRecaCatchAtLengthAndAge.html">ReportRecaCatchAtLengthAndAge</a>()</code>,
<code><a href="ReportRecaCatchAtLength.html">ReportRecaCatchAtLength</a>()</code>,
<code><a href="ReportRecaCatchStatistics.html">ReportRecaCatchStatistics</a>()</code>,
<code><a href="ReportRecaLengthAtAge.html">ReportRecaLengthAtAge</a>()</code>,
<code><a href="ReportRecaParameterStatistics.html">ReportRecaParameterStatistics</a>()</code>,
<code><a href="ReportRecaWeightAtAge.html">ReportRecaWeightAtAge</a>()</code>,
<code><a href="RunRecaModels.html">RunRecaModels</a>()</code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Arne Johannes Holmin, Edvin Fuglebakk.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

