<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="annotates metier to data table"><title>Annotate metier — appendMetier • RstoxFDA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Annotate metier — appendMetier"><meta property="og:description" content="annotates metier to data table"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">RstoxFDA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0-9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/StoX-data-preparation.html">StoX FDA data preparation (baseline)</a>
    <a class="dropdown-item" href="../articles/Stox-FDA-overview.html">StoX Fisheries overview (report)</a>
    <a class="dropdown-item" href="../articles/stox-reca.html">StoX-Reca (analysis)</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/StoXProject/RstoxFDA/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Annotate metier</h1>
      <small class="dont-index">Source: <a href="https://github.com/StoXProject/RstoxFDA/blob/HEAD/R/metierAnnotation.R" class="external-link"><code>R/metierAnnotation.R</code></a></small>
      <div class="d-none name"><code>appendMetier.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>annotates metier to data table</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">appendMetier</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">metiertable</span>,</span>
<span>  <span class="va">gearColumn</span>,</span>
<span>  targetColumn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  meshSizeColumn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  selectivityDeviceColumn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  selectivityDeviceMeshSizeColumn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  metierColName <span class="op">=</span> <span class="st">"metier"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p><code><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> with data to be annotated</p></dd>


<dt>metiertable</dt>
<dd><p><code><a href="MetierTable.html">MetierTable</a></code> with metier definitions, or object that can be read with <code><a href="readMetierTable.html">readMetierTable</a></code></p></dd>


<dt>gearColumn</dt>
<dd><p>character() identifies the column in 'data' that encodes gear. Gear definition must match metiertable$gearcode</p></dd>


<dt>targetColumn</dt>
<dd><p>character(), optional, identifies the column in 'data' that encodes target species. Definition must match metiertable$target</p></dd>


<dt>meshSizeColumn</dt>
<dd><p>integer(), optional, identifies the column in 'data' that encodes the mesh size of the gear.</p></dd>


<dt>selectivityDeviceColumn</dt>
<dd><p>character(), optional, identifies the column in 'data' that encodes selectivitydevices mounted on gear. Definition must mathc metiertable$selectivityDevice</p></dd>


<dt>selectivityDeviceMeshSizeColumn</dt>
<dd><p>integer(), optional, identifies the column in 'data' that encodes the mesh size of any mounted selectivity device.</p></dd>


<dt>metierColName</dt>
<dd><p>character() name of the column that should be appended to 'data'</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> 'data' with the column 'metierColName' appended (character).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Annotates data with metier, given a metier definition (<code><a href="MetierTable.html">MetierTable</a></code>) and a selection of data-columns that idenitfies metier-defining variables.
 Metier names are defined by the column 'metier' in 'metiertable', and does not have to reflect the information actually used for annotation.
 For example, metiers of the type "OTB_DEF", indicating both gear and target assemblage, can be configured based only on gear codes.</p>
<p>For the metier-defining variables 'gearcode', 'target' and 'selectivityDevice' (see <code><a href="MetierTable.html">MetierTable</a></code>), missing values are matches with missing values.
 That is, a metier that is defined with a missing value for 'target'
 will be annotated to otherwise matching data which has a missing value in the 'targetColumn'.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">metier4table</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">activityCensus</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># annotate metier lvl 4 on the cencus based on gear, and compare with finer gear declaration.</span></span></span>
<span class="r-in"><span> <span class="va">annotated</span> <span class="op">&lt;-</span> <span class="fu">appendMetier</span><span class="op">(</span><span class="va">activityCensus</span>,</span></span>
<span class="r-in"><span>          <span class="va">metier4table</span>,</span></span>
<span class="r-in"><span>          <span class="st">"gearNS"</span>,</span></span>
<span class="r-in"><span>          metierColName <span class="op">=</span> <span class="st">"metier4"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">annotated</span><span class="op">$</span><span class="va">metier4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  FPO   GN  GNS  HAR  LHM   LL  LLD  LTL  MIS  OTB  OTM  OTT   PS  PTB  PTM  SSC </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   12 1690  252    4    6  812   10    2   27 2069  282  144  855  324  239 2023 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   SX  TBN  TBS   TX </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    6   50  922 1508 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">metier5table</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># annotate metier lvl 5 on COD-catches based on only gear,</span></span></span>
<span class="r-in"><span> <span class="co"># and compare with declarations for shrimp fisheries</span></span></span>
<span class="r-in"><span> <span class="va">annotated</span> <span class="op">&lt;-</span> <span class="fu">appendMetier</span><span class="op">(</span><span class="va">activityCensus</span><span class="op">[</span><span class="va">activityCensus</span><span class="op">$</span><span class="va">species</span><span class="op">==</span><span class="st">"COD"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>          <span class="va">metier5table</span>,</span></span>
<span class="r-in"><span>          <span class="st">"gearNS"</span>,</span></span>
<span class="r-in"><span>          metierColName <span class="op">=</span> <span class="st">"metier5"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">annotatedShrimp</span> <span class="op">&lt;-</span> <span class="va">annotated</span><span class="op">[</span><span class="va">annotated</span><span class="op">$</span><span class="va">targetFAO</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PAN"</span>, <span class="st">"PRA"</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">annotatedShrimp</span><span class="op">$</span><span class="va">gearFAO</span>, <span class="va">annotatedShrimp</span><span class="op">$</span><span class="va">targetFAO</span>, sep<span class="op">=</span><span class="st">"/"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="va">annotatedShrimp</span><span class="op">$</span><span class="va">metier5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           MIS_MIS OTB_CRU OTB_DEF PTB_DEF</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   OTB/PRA       0       0      21       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PTB/PRA       0       0       0       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TB/PRA        1       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TBN/PAN       0       1       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TBS/PAN       0       2       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TBS/PRA       0      22       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TM/PRA        1       0       0       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   TMS/PRA       0       1       0       0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">metier6table</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="co"># annotate metier lvl 6 on COD-catches based on gear and mesh size,</span></span></span>
<span class="r-in"><span> <span class="co"># and compare with lvl 5 annotations from last example</span></span></span>
<span class="r-in"><span> <span class="va">annotated</span> <span class="op">&lt;-</span> <span class="fu">appendMetier</span><span class="op">(</span><span class="va">activityCensus</span><span class="op">[</span><span class="va">activityCensus</span><span class="op">$</span><span class="va">species</span><span class="op">==</span><span class="st">"COD"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>          <span class="va">metier6table</span>,</span></span>
<span class="r-in"><span>          <span class="st">"gearNS"</span>,</span></span>
<span class="r-in"><span>          meshSizeColumn <span class="op">=</span> <span class="st">"meshSize"</span>,</span></span>
<span class="r-in"><span>          metierColName <span class="op">=</span> <span class="st">"metier6"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">annotated</span> <span class="op">&lt;-</span> <span class="fu">appendMetier</span><span class="op">(</span><span class="va">annotated</span>,</span></span>
<span class="r-in"><span>           <span class="va">metier5table</span>,</span></span>
<span class="r-in"><span>           <span class="st">"gearNS"</span>,</span></span>
<span class="r-in"><span>           metierColName <span class="op">=</span> <span class="st">"metier5"</span><span class="op">)</span></span></span>
<span class="r-in"><span> <span class="va">annotatedShrimp</span> <span class="op">&lt;-</span> <span class="va">annotated</span><span class="op">[</span><span class="va">annotated</span><span class="op">$</span><span class="va">targetFAO</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PAN"</span>, <span class="st">"PRA"</span><span class="op">)</span>,<span class="op">]</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">annotatedShrimp</span><span class="op">$</span><span class="va">metier5</span>, <span class="va">annotatedShrimp</span><span class="op">$</span><span class="va">metier6</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           OTB_CRU_16-31_0_0_all OTB_CRU_32-69_0_0_all OTB_DEF_&gt;=120_0_0_all</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MIS_MIS                     0                     2                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   OTB_CRU                     2                    22                     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   OTB_DEF                     0                    16                     5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PTB_DEF                     0                     1                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           OTB_SPF_32-69_0_0_all</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MIS_MIS                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   OTB_CRU                     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   OTB_DEF                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   PTB_DEF                     0</span>
<span class="r-in"><span> </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Arne Johannes Holmin, Edvin Fuglebakk.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

