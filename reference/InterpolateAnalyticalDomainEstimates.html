<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Interpolate means and frequencies for zero-abundance domains — InterpolateAnalyticalDomainEstimates • RstoxFDA</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interpolate means and frequencies for zero-abundance domains — InterpolateAnalyticalDomainEstimates"><meta name="description" content="Interpolate means and frequences for domains with no estimated abundance (domains not sampled)"><meta property="og:description" content="Interpolate means and frequences for domains with no estimated abundance (domains not sampled)"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RstoxFDA</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0-9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Stox-Analytical.html">StoX-Analytical-Estimates</a></li>
    <li><a class="dropdown-item" href="../articles/StoX-data-preparation.html">StoX FDA data preparation (baseline)</a></li>
    <li><a class="dropdown-item" href="../articles/Stox-FDA-overview.html">StoX Fisheries overview (report)</a></li>
    <li><a class="dropdown-item" href="../articles/stox-reca.html">StoX-Reca (analysis)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/StoXProject/RstoxFDA/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Interpolate means and frequencies for zero-abundance domains</h1>
      <small class="dont-index">Source: <a href="https://github.com/StoXProject/RstoxFDA/blob/master/R/StoxAnalyticalBaselineFunctions.R" class="external-link"><code>R/StoxAnalyticalBaselineFunctions.R</code></a></small>
      <div class="d-none name"><code>InterpolateAnalyticalDomainEstimates.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Interpolate means and frequences for domains with no estimated abundance (domains not sampled)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">InterpolateAnalyticalDomainEstimates</span><span class="op">(</span></span>
<span>  <span class="va">AnalyticalPopulationEstimateData</span>,</span>
<span>  <span class="va">StoxLandingData</span>,</span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Strict"</span>, <span class="st">"StratumMean"</span><span class="op">)</span>,</span>
<span>  DomainMarginVariables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  Epsilon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-analyticalpopulationestimatedata">AnalyticalPopulationEstimateData<a class="anchor" aria-label="anchor" href="#arg-analyticalpopulationestimatedata"></a></dt>
<dd><p><code><a href="AnalyticalPopulationEstimateData.html">AnalyticalPopulationEstimateData</a></code> with analytical estimates</p></dd>


<dt id="arg-stoxlandingdata">StoxLandingData<a class="anchor" aria-label="anchor" href="#arg-stoxlandingdata"></a></dt>
<dd><p>Landing data for the entire fishery / target population</p></dd>


<dt id="arg-method">Method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>method for inferring means and frequencies. See details.</p></dd>


<dt id="arg-domainmarginvariables">DomainMarginVariables<a class="anchor" aria-label="anchor" href="#arg-domainmarginvariables"></a></dt>
<dd><p>Domain Variables used for interpolation with the 'StratumMean' Method. Must be variables in StoxLandingData and Domain Variables in 'AnalyticalPopulationEstimateData'. See details.</p></dd>


<dt id="arg-epsilon">Epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>factor for representing relative frequencies for 0-abundance domains, used for interpolation with the 'StratumMean' Method. See details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code><a href="AnalyticalPopulationEstimateData.html">AnalyticalPopulationEstimateData</a></code> with parameters for unsampled domains</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function infers parameters for unsampled domains that are present in census data (landings).
This function only infers precence of unsampled domains from census-data, and provide options for some pragmatic approximations to substitute for estimates for these domains.
The function does not introduce landed weights, or other knowledge from landings,
except for the fact that domains are present in the landings data. All inference about unkown values are taken from the provided estimates ('AnalyticalPopulationEstimateData').</p>
<p>The Domain-variables provided in the argument 'DomainMarginVariables' are compared with landings ('StoxLandingData')
to detect if the census contains values and combinations for these variables that are not present in the samples.
Corresponding domains are then introduced into the analytical estimates results according to the option for the argument 'Method'</p>
<p>Subsequent ratio-estimation may make use of this information to also make use of total-weight information from landings (see <code>link[RstoxFDA]{AnalyticalRatioEstimate}</code>).
For design based approaches, unsampled domains have estimates of zero abundance, frequencies and totals, and hence undefined means.
Such zero-domains may be only implicitly encoded in 'AnalyticalPopulationEstimateData',
and this function may make that encoding explicit for by use of the option 'Strict' for Method.
The 'Strict' Method introduces unsampled domains with abundance, total and frequencies of 0, and NaN means.</p>
<p>In order to prepare ratio-estimation (see. <code><a href="AnalyticalRatioEstimate.html">AnalyticalRatioEstimate</a></code>), it may be desirable to infer some plausible values for means and frequencies of unsampled domains.
This is facilitated by the option 'StratumMean' for 'Method'. This method will calculate aggregate statistcs for each stratum over the
domain variables, and use this average for means and frequencies for the marginal domains that have zero abundance. Marginal domains are
domains defined by combining statistics for all other domain variables than those identified in DomainMarginVariables.</p>
<p>For instance, one may one to infer frequencies and means for unsampled gears, as the mean of all sampled gears in a stratum.
This can be obtained by providing DomainMarginVariables='Gear', or unsampled combinations of gears and quarters could be similarly
specifyed by DomainMarginVariables=c('Gear','Quarter'). The DomainMarginVariables must be domain variables in 'AnalyticalPopulationEstimateData'
and are typically PSU-domains (see. <code><a href="AnalyticalPSUEstimate.html">AnalyticalPSUEstimate</a></code>).</p>
<p>Since frequencies are normalized to strata, they need to be re-normalized after inclusion of positive frequencies in these domains.
In order to reflect their low abundance in the sampling frame, the frequencies are scaled to a low-value provided in the argument 'Epsilon'.
Epsilon indicate the precense of these domains, as deduced from census-data, but should be chosen low enough to be considered practically zero,
to be consistent with the result of sampling-based estimation. For this reason, abundances and totals are set to NA for these domains,
but frequencies need to present to capture for instance age-distributions in the domain.</p>
<p>Subsequent ratio-estimation may provide relastic estimates of abundances and relative frequencies between PSU-domains.</p>
<p>The domain estimates in 'AnalyticalPopulationEstimateData' are identied by a stratum \(s\) and a set of domain variables \(D\).
The domain variables can be divided into the set \(M\) and \(N\), where \(M\) are the 'DomainMarginVariables'. Let \((m+n)\)
denote a domain defined by the combination of the variables \(m\) and \(n\).
For each \(d \in N\), we define the stratum statistics:</p><dl><dt>frequency</dt>
<dd><p>$$\widehat{f}^{(s,d)}=\sum_{m \in M}\widehat{f}^{(s,d+m)}$$</p>
<p>with covariance:</p>
<p>$$\widehat{CoVar}(\widehat{f}^{(s,d_{1})}, \widehat{f}^{(s,d_{2})})=\sum_{m \in M}\widehat{CoVar}(\widehat{f}^{(s,d{1}+m)}, \widehat{f}^{(s,d_{2}+m)})$$</p></dd>

<dt>mean</dt>
<dd><p>$$\widehat{\mu}^{(s,d,v)}=\frac{1}{\sum_{m \in M}I(s,d+m)\widehat{f}^{(s,d+m)}}\sum_{m \in M}I(s,d+m)\widehat{f}^{(s,d+m)}\widehat{\mu}^{(s,d+m,v)}$$
where \(v\) denote the variable that the mean is estimated for, and \(I(s,d)\) is an indicator functon that is 1
if a mean is defined for domain \(d\) in stratum \(s\), otherwise 0.</p>
<p>with covariance:</p>
<p>$$\widehat{CoVar}(\widehat{\mu}^{(s,d_{1},v_{1})}, \widehat{\mu}^{(s,d_{2},v_{2})})=\frac{1}{\sum_{m \in M}z^{s,d_{1},d_{2},m}}\sum_{m \in M}z^{s,d_{1},d_{2},m}\widehat{CoVar}(\widehat{\mu}^{(s,d_{1}+m, v_{1})}, \widehat{\mu}^{(s,d_{2}+m, v_{2})})$$
where:
$$z^{s,d_{1},d_{2},m}=I(s,d_{1}+m)I(s,d_{2}+m)\widehat{f}^{(s,d_{1}+m)}\widehat{f}^{(s,d_{2}+m)}$$</p></dd>


</dl><p>These stratum statistics are used to interpolate to zero-abundance domains, as follows.
Let \(D'\) denote the combinations of 'DomainMarginVariables' that have zero estimated abundance.
For each \(d \in N\) and \(n' \in D'\), statistics are defined as:</p>
<dl><dt>frequency</dt>
<dd><p>$$\widehat{f}^{(s,d+n')}=\epsilon\widehat{f}^{(s,d)}$$
where \(\epsilon\) corresponds to the argument 'Epsilon'</p>
<p>with covariance:</p>
<p>$$\widehat{CoVar}(\widehat{f}^{(s,d_{1}+n')}, \widehat{f}^{(s,d_{2}+n')})=\epsilon^{2}\widehat{CoVar}(\widehat{f}^{(s,d_{1})}, \widehat{f}^{(s,d_{2})})$$</p></dd>

<dt>mean</dt>
<dd><p>$$\widehat{\mu}^{(s,d+n',v)}=\widehat{\mu}^{(s,d,v)}$$</p>
<p>with covariance:</p>
<p>$$\widehat{CoVar}(\widehat{\mu}^{(s,d_{1}+n',v_{1})}, \widehat{\mu}^{(s,d_{2}+n',v_{2})})=\widehat{CoVar}(\widehat{\mu}^{(s,d_{1},v_{1})}, \widehat{\mu}^{(s,d_{2},v_{2})})$$</p></dd>


</dl><p>To renormalize frequencies, a minor adjustment is also made to the non-zero abundance domains:</p>
<p>Let \(D''\) denote the combinations of 'DomainMarginVariables' that have positive estimated abundance.
For each \(d \in N\) and \(n'' \in D''\), the frequency is defined as:</p>
<p>$$\widehat{f{*}}^{(s,d+n'')}=(1-\epsilon r)\widehat{f}^{(s,d+n'')}$$
where \(r=\frac{|D'|}{|D''|}\), the ratio of zero-abundance domains to non-zero-abundance marginal domains.</p>
<p>Similarly, the covariance is:
$$\widehat{CoVar^{*}}(\widehat{f}^{(s,d_{1}+n'')}, \widehat{f}^{(s,d_{2}+n'')}=(1-\epsilon r)^{2}\widehat{CoVar}(\widehat{f}^{(s,d_{1}+n'')}, \widehat{f}^{(s,d_{2}+n'')})$$</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="AnalyticalPopulationEstimate.html">AnalyticalPopulationEstimate</a></code>, <code><a href="AnalyticalRatioEstimate.html">AnalyticalRatioEstimate</a></code>, <code><a href="AggregateAnalyticalEstimate.html">AggregateAnalyticalEstimate</a></code>, <code><a href="ExtendAnalyticalSamplingFrameCoverage.html">ExtendAnalyticalSamplingFrameCoverage</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Edvin Fuglebakk, Arne Johannes Holmin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

